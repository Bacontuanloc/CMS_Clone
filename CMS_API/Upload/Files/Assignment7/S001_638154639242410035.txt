using System;
using System.Collections.Generic;

namespace Generic_Homework
{
    class Student
    {


        public Student(int studentID, string studentName)
        {
            StudentID = studentID;
            StudentName = studentName;
        }

        public int StudentID { get; set; }
        public string StudentName { get; set; }
        public override string ToString()
        {
            return $"{StudentID} - {StudentName}";
        }
    }
    public delegate void OnNumberOfStudnetChange(int a, int b);

    class Course
    {
        public event OnNumberOfStudnetChange OnNumberOfStudnetChange;

        private Dictionary<Student, double> list;

        public Course(int courseID, string courseTitle)
        {
            this.CourseID = courseID;
            this.CourseTitle = courseTitle;
            list = new Dictionary<Student, double>();
        }

        public int CourseID { get; set; }

        public string CourseTitle { get; set; }

        public void AddStudent(Student p, double g)
        {

            list.Add(p, g);
            if (OnNumberOfStudnetChange != null)
            {
                OnNumberOfStudnetChange(list.Count - 1, list.Count);

            }

        }
        public void RemoveStudent(int studentID)
        {
            foreach (Student item in list.Keys)
            {
                if (item.StudentID == studentID)
                {
                    list.Remove(item);
                    if (OnNumberOfStudnetChange != null)
                    {
                        OnNumberOfStudnetChange(list.Count+1,list.Count);

                    }
                }
            }
           
        }
        public override string ToString()
        {
            string s = $"Course: {CourseID} - {CourseTitle}\n";
            foreach (KeyValuePair<Student, double> item in list)
            {
                s += $"Student: {item.Key} - Mark: {item.Value}\n";
            }
            return s;
        }

    }
   

    
    class Program
    {
        static void Notify(int oldN, int newN)
        {
            Console.WriteLine($"Number of student has change from {oldN} to {newN}");
        }
        static void Main(string[] args)
        {
            Student s = new Student(1, "Trung");
            Course c = new Course(1, "PRN211");
            c.AddStudent(s, 7.5);
            c.AddStudent(new Student(2, "Hoa"), 7.8);
            c.AddStudent(new Student(3, "Vinh"), 7.4);
            Console.WriteLine(c);
            c.RemoveStudent(2);
            Console.WriteLine("\n-------------After Remove");
            Console.WriteLine(c);

            Console.WriteLine("\n --------After add envent hander:");
            c.OnNumberOfStudnetChange += Notify;
            c.AddStudent(new Student(4, "Hoang Anh"), 8);
            c.RemoveStudent(1);
            Console.WriteLine(c);
            Console.ReadLine();

        }
    }
}